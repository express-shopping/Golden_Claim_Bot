<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Golden Claim | Pro</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #f3ba2f; --bg: #0b0b0b; --card: #1a1a1a; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Cairo', sans-serif; overflow: hidden; -webkit-tap-highlight-color: transparent; }
        .header { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #111; border-bottom: 1px solid #333; }
        .content { height: calc(100vh - 145px); overflow-y: auto; padding: 20px; text-align: center; }
        .page { display: none; } .page.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .bal-val { font-size: 45px; font-weight: 900; color: #fff; margin: 5px 0; }
        .mine-btn { width: 220px; height: 220px; border-radius: 50%; background: radial-gradient(circle, #333, #000); border: 8px solid #222; margin: 25px auto; display: flex; align-items: center; justify-content: center; cursor: pointer; position: relative; }
        .mine-btn.active { border-color: var(--gold); box-shadow: 0 0 25px rgba(243,186,47,0.4); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        .btn-main { background: var(--gold); color: #000; border: none; width: 100%; padding: 12px; border-radius: 12px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .nav { position: fixed; bottom: 0; width: 100%; background: #111; display: flex; border-top: 1px solid #222; padding: 15px 0 35px 0; }
        .n-item { flex: 1; text-align: center; color: #666; cursor: pointer; }
        .n-item.active { color: var(--gold); }
        #toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: var(--gold); color: #000; padding: 10px 25px; border-radius: 30px; display: none; z-index: 10000; font-weight: bold; }
        /* ØªØµÙ…ÙŠÙ… Ø²Ø± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„ÙŠÙƒÙˆÙ† Ù…ØªÙ†Ø§Ø³Ù‚Ø§Ù‹ */
        #ton-connect-button { display: inline-block; margin-top: 15px; }
    </style>
</head>
<body>

<div id="toast"></div>

<div class="header">
    <div style="display: flex; align-items: center; gap: 10px;">
        <img id="u-pic" src="https://ui-avatars.com/api/?name=User" style="width:35px; border-radius:50%; border:2px solid var(--gold);">
        <span id="u-name">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
    </div>
    <div id="mini-wallet" style="font-size: 10px; color: #888;">Ù„Ù… ØªØ±Ø¨Ø·</div>
</div>

<div class="content">
    <div id="p-mine" class="page active">
        <div style="color:#aaa;">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø°Ù‡Ø¨ÙŠ</div>
        <div class="bal-val" id="bal">0.0000</div>
        <div id="m-circle" class="mine-btn" onclick="startMining()">
            <img src="https://cdn-icons-png.flaticon.com/512/6585/6585012.png" width="100">
        </div>
        <div id="timer" style="color:var(--gold); font-size:18px; font-weight:bold;">Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¨Ø¯Ø¡</div>
    </div>

    <div id="p-tasks" class="page">
        <h3>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h3>
        <div style="background:#1a1a1a; padding:15px; border-radius:15px; display:flex; justify-content:space-between; align-items:center;">
            <span>Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù‚Ù†Ø§Ø©</span>
            <button class="btn-main" style="width:80px;" onclick="completeTask(5000)">Ø¨Ø¯Ø¡</button>
        </div>
    </div>

    <div id="p-wallet" class="page">
        <h3>Ø§Ø±Ø¨Ø· Ù…Ø­ÙØ¸Ø© TON</h3>
        <div style="background:#1a1a1a; padding:30px 15px; border-radius:20px;">
            <p style="font-size:13px; color:#aaa;">ØªØ­ØªØ§Ø¬ Ù„Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„ØªØªÙ…ÙƒÙ† Ù…Ù† Ø³Ø­Ø¨ Ø£Ø±Ø¨Ø§Ø­Ùƒ Ù„Ø§Ø­Ù‚Ø§Ù‹</p>
            <div id="ton-connect-button"></div>
            
            <div id="wallet-info" style="margin-top:20px; font-size:12px; word-break:break-all; color:var(--gold);"></div>
        </div>
    </div>
</div>

<div class="nav">
    <div class="n-item active" onclick="tab('p-mine', this)">â›ï¸<br>ØªØ¹Ø¯ÙŠÙ†</div>
    <div class="n-item" onclick="tab('p-tasks', this)">ğŸ“‹<br>Ù…Ù‡Ø§Ù…</div>
    <div class="n-item" onclick="tab('p-wallet', this)">ğŸ‘›<br>Ù…Ø­ÙØ¸Ø©</div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    // 1. Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ù…Ø­ÙØ¸Ø©: ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
    const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
        manifestUrl: 'https://ton-connect.github.io/demo-dapp-with-react/tonconnect-manifest.json', // Ø±Ø§Ø¨Ø· ØªØ¬Ø±ÙŠØ¨ÙŠ Ø±Ø³Ù…ÙŠ
        buttonRootId: 'ton-connect-button'
    });

    // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„
    tonConnectUI.onStatusChange(wallet => {
        if (wallet) {
            const addr = wallet.account.address;
            document.getElementById('wallet-info').innerText = "ØªÙ… Ø§Ù„Ø±Ø¨Ø·: " + addr.substring(0,6) + "..." + addr.substring(addr.length-4);
            document.getElementById('mini-wallet').innerText = "Ù…ØªØµÙ„ âœ…";
            showToast("ØªÙ… Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰");
        } else {
            document.getElementById('wallet-info').innerText = "Ø§Ù„Ù…Ø­ÙØ¸Ø© ØºÙŠØ± Ù…ØªØµÙ„Ø©";
            document.getElementById('mini-wallet').innerText = "ØºÙŠØ± Ù…ØªØµÙ„";
        }
    });

    // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
    let balance = parseFloat(localStorage.getItem('g_bal')) || 0;
    let endTime = localStorage.getItem('g_end');
    let limit = 6; // 6 Ø³Ø§Ø¹Ø§Øª

    function sync() {
        document.getElementById('bal').innerText = balance.toFixed(4);
        document.getElementById('u-name').innerText = tg.initDataUnsafe.user?.first_name || "Ù„Ø§Ø¹Ø¨";
        localStorage.setItem('g_bal', balance);
    }

    function showToast(m) {
        const t = document.getElementById('toast');
        t.innerText = m; t.style.display = 'block';
        setTimeout(() => t.style.display = 'none', 3000);
    }

    // Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØªØ¹Ø¯ÙŠÙ†
    function startMining() {
        if (!endTime) {
            endTime = Date.now() + (limit * 3600000);
            localStorage.setItem('g_end', endTime);
            tg.HapticFeedback.impactOccurred('medium');
            showToast("Ø¨Ø¯Ø£ Ø§Ù„ØªØ¹Ø¯ÙŠÙ†! ğŸš€");
        } else if (Date.now() >= endTime) {
            balance += 0.5; // Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ†
            endTime = null;
            localStorage.removeItem('g_end');
            tg.HapticFeedback.notificationOccurred('success');
            showToast("ØªÙ… Ø¬Ù…Ø¹ Ø§Ù„Ø°Ù‡Ø¨! ğŸ’°");
            sync();
        }
    }

    setInterval(() => {
        const timer = document.getElementById('timer');
        const circle = document.getElementById('m-circle');
        if (endTime) {
            let diff = endTime - Date.now();
            if (diff > 0) {
                circle.classList.add('active');
                let h = Math.floor(diff / 3600000);
                let m = Math.floor((diff % 3600000) / 60000);
                let s = Math.floor((diff % 60000) / 1000);
                timer.innerText = `${h}:${m}:${s}`;
            } else {
                circle.classList.remove('active');
                timer.innerText = "Ø§Ø¬Ù…Ø¹ Ø§Ù„Ø¢Ù†! âœ¨";
            }
        } else {
            circle.classList.remove('active');
            timer.innerText = "Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¨Ø¯Ø¡";
        }
    }, 1000);

    function tab(id, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.n-item').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        el.classList.add('active');
    }

    function completeTask(r) {
        balance += r;
        sync();
        showToast("ØªÙ…Øª Ø§Ù„Ù…Ù‡Ù…Ø©! ğŸ");
    }

    sync();
</script>
</body>
</html>

