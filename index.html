<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Golden Claim Premium</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #f3ba2f; --bg: #050505; --card: #121212; --text: #ffffff; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); color: var(--text); font-family: 'Cairo', sans-serif; overflow: hidden; }

        /* Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .header { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: rgba(18, 18, 18, 0.9); backdrop-filter: blur(10px); border-bottom: 1px solid #222; position: sticky; top: 0; z-index: 100; }
        .user-box { display: flex; align-items: center; gap: 10px; }
        #avatar { width: 38px; height: 38px; border-radius: 12px; border: 2px solid var(--gold); box-shadow: 0 0 10px rgba(243, 186, 47, 0.3); }
        
        /* Ø§Ù„Ø±ØµÙŠØ¯ */
        .balance-section { text-align: center; padding: 30px 0; background: radial-gradient(circle at center, #1a1a1a 0%, #050505 100%); }
        .coin-icon { width: 40px; vertical-align: middle; margin-left: 10px; }
        .amount { font-size: 48px; font-weight: 900; letter-spacing: -1px; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ† */
        .mining-area { position: relative; width: 240px; height: 240px; margin: 0 auto; display: flex; align-items: center; justify-content: center; }
        .mining-circle { width: 220px; height: 220px; border-radius: 50%; background: #111; border: 8px solid #1a1a1a; display: flex; align-items: center; justify-content: center; transition: 0.2s; cursor: pointer; position: relative; z-index: 2; }
        .mining-circle:active { transform: scale(0.92); }
        .mining-circle.active { border-color: var(--gold); box-shadow: 0 0 40px rgba(243, 186, 47, 0.2); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(243, 186, 47, 0.4); } 70% { box-shadow: 0 0 0 20px rgba(243, 186, 47, 0); } 100% { box-shadow: 0 0 0 0 rgba(243, 186, 47, 0); } }

        /* Ø§Ù„ÙƒØ±ÙˆØª ÙˆØ§Ù„Ù…Ù‡Ø§Ù… */
        .pages-container { height: calc(100vh - 150px); overflow-y: auto; padding-bottom: 80px; }
        .page { display: none; padding: 20px; }
        .page.active { display: block; animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .card { background: var(--card); border-radius: 20px; padding: 15px; margin-bottom: 12px; border: 1px solid #222; display: flex; align-items: center; justify-content: space-between; }
        .btn-action { background: var(--gold); color: #000; border: none; padding: 10px 20px; border-radius: 12px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .btn-action:active { transform: scale(0.95); }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙÙ„ÙŠØ© */
        .tab-bar { position: fixed; bottom: 15px; left: 15px; right: 15px; background: rgba(20, 20, 20, 0.95); backdrop-filter: blur(15px); border-radius: 25px; display: flex; padding: 10px; border: 1px solid #333; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .tab-item { flex: 1; text-align: center; color: #666; font-size: 11px; font-weight: bold; transition: 0.3s; cursor: pointer; }
        .tab-item.active { color: var(--gold); }
        .tab-item span { display: block; font-size: 22px; margin-bottom: 2px; }

        #notification { position: fixed; top: 80px; left: 50%; transform: translateX(-50%); background: var(--gold); color: #000; padding: 8px 20px; border-radius: 10px; font-weight: bold; display: none; z-index: 1000; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
    </style>
</head>
<body>

<div id="notification"></div>

<div class="header">
    <div class="user-box">
        <img id="avatar" src="">
        <span id="username">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</span>
    </div>
    <div id="ton-connect"></div>
</div>

<div class="pages-container">
    <div id="mine" class="page active">
        <div class="balance-section">
            <div class="amount" id="main-bal">0.00</div>
            <div style="color: #888; font-size: 14px;">GOLD COINS <img src="https://cdn-icons-png.flaticon.com/512/6585/6585012.png" class="coin-icon"></div>
        </div>

        <div class="mining-area">
            <div id="circle" class="mining-circle" onclick="processMining()">
                <img src="https://cdn-icons-png.flaticon.com/512/6585/6585012.png" width="130">
            </div>
        </div>
        
        <p id="timer-text" style="color: var(--gold); font-weight: 900; margin-top: 20px;">Ø¬Ø§Ù‡Ø² Ù„Ø¬Ù…Ø¹ Ø§Ù„Ø°Ù‡Ø¨</p>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px;">
            <div class="card" style="flex-direction: column; gap: 10px;">
                <small style="color: #888;">Ø§Ù„Ø³Ø±Ø¹Ø© (+0.05)</small>
                <button class="btn-action" style="width: 100%;" onclick="upgrade('speed')">ØªØ·ÙˆÙŠØ± (10)</button>
            </div>
            <div class="card" style="flex-direction: column; gap: 10px;">
                <small style="color: #888;">Ø§Ù„Ø®Ø²Ø§Ù† (+2h)</small>
                <button class="btn-action" style="width: 100%;" onclick="upgrade('tank')">ØªØ·ÙˆÙŠØ± (20)</button>
            </div>
        </div>
    </div>

    <div id="tasks" class="page">
        <h2 style="text-align: right;">Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h2>
        <div class="card">
            <div style="text-align: right;">
                <div style="font-weight: bold;">Ø§Ù†Ø¶Ù… Ù„Ù‚Ù†Ø§Ø© Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…</div>
                <small style="color: var(--gold);">+5,000 Ø°Ù‡Ø¨</small>
            </div>
            <button class="btn-action" onclick="claimTask(5000)">Ø¥ØªÙ…Ø§Ù…</button>
        </div>
        <div class="card">
            <div style="text-align: right;">
                <div style="font-weight: bold;">Ø¯Ø¹ÙˆØ© ØµØ¯ÙŠÙ‚ Ù†Ø´Ø·</div>
                <small style="color: var(--gold);">+10,000 Ø°Ù‡Ø¨</small>
            </div>
            <button class="btn-action" onclick="copyLink()">Ø¯Ø¹ÙˆØ©</button>
        </div>
    </div>

    <div id="wallet" class="page">
        <h2 style="text-align: right;">Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙˆØ§Ù„Ø³Ø­Ø¨</h2>
        <div class="card" style="height: 200px; flex-direction: column; justify-content: center; gap: 15px;">
            <div class="amount" id="wallet-bal">0.00</div>
            <p style="color: #888;">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨: 100.00 Ø°Ù‡Ø¨</p>
            <button class="btn-action" style="width: 80%; padding: 15px;" onclick="notify('Ø³ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø³Ø­Ø¨ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø¯Ø±Ø§Ø¬ Ù‚Ø±ÙŠØ¨Ø§Ù‹!')">Ø·Ù„Ø¨ Ø³Ø­Ø¨ Ø±ØµÙŠØ¯</button>
        </div>
    </div>
</div>

<div class="tab-bar">
    <div class="tab-item active" onclick="showPage('mine', this)"><span>â›ï¸</span>Ø§Ù„ØªØ¹Ø¯ÙŠÙ†</div>
    <div class="tab-item" onclick="showPage('tasks', this)"><span>ğŸ“‹</span>Ø§Ù„Ù…Ù‡Ø§Ù…</div>
    <div class="tab-item" onclick="showPage('wallet', this)"><span>ğŸ‘›</span>Ø§Ù„Ù…Ø­ÙØ¸Ø©</div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();
    tg.headerColor = '#121212';

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø­ÙØ¸Ø©
    const tonUI = new TON_CONNECT_UI.TonConnectUI({
        manifestUrl: 'https://raw.githubusercontent.com/ton-community/tutorials/main/03-client/test/public/tonconnect-manifest.json',
        buttonRootId: 'ton-connect'
    });

    // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (LocalStorage)
    let user = {
        bal: parseFloat(localStorage.getItem('gold_bal')) || 0,
        speed: parseFloat(localStorage.getItem('gold_spd')) || 0.01,
        tank: parseInt(localStorage.getItem('gold_tnk')) || 6,
        endTime: localStorage.getItem('gold_end') || null
    };

    function notify(msg) {
        const el = document.getElementById('notification');
        el.innerText = msg; el.style.display = 'block';
        setTimeout(() => el.style.display = 'none', 3000);
    }

    function updateUI() {
        document.getElementById('main-bal').innerText = user.bal.toFixed(2);
        document.getElementById('wallet-bal').innerText = user.bal.toFixed(2);
        document.getElementById('username').innerText = tg.initDataUnsafe.user?.first_name || "Mugahed";
        document.getElementById('avatar').src = tg.initDataUnsafe.user?.photo_url || "https://ui-avatars.com/api/?name=M";
        
        localStorage.setItem('gold_bal', user.bal);
        localStorage.setItem('gold_spd', user.speed);
        localStorage.setItem('gold_tnk', user.tank);
    }

    function processMining() {
        if (!user.endTime) {
            user.endTime = Date.now() + (user.tank * 3600000);
            localStorage.setItem('gold_end', user.endTime);
            tg.HapticFeedback.impactOccurred('heavy');
            notify("Ø¨Ø¯Ø£ Ø§Ù„ØªØ¹Ø¯ÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­! ğŸš€");
        } else if (Date.now() >= user.endTime) {
            user.bal += (user.speed * user.tank);
            user.endTime = null;
            localStorage.removeItem('gold_end');
            tg.HapticFeedback.notificationOccurred('success');
            notify("ØªÙ… Ø¬Ù…Ø¹ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­! ğŸ’°");
        }
        updateUI();
    }

    function loop() {
        const txt = document.getElementById('timer-text');
        const cir = document.getElementById('circle');
        if (user.endTime) {
            let diff = user.endTime - Date.now();
            if (diff > 0) {
                cir.classList.add('active');
                let h = Math.floor(diff/3600000);
                let m = Math.floor((diff%3600000)/60000);
                txt.innerText = `Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ¹Ø¯ÙŠÙ†: ${h}Ø³ Ùˆ ${m}Ø¯ Ù…ØªØ¨Ù‚ÙŠØ©`;
            } else {
                cir.classList.remove('active');
                txt.innerText = "Ø§Ø¬Ù…Ø¹ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø¢Ù†! âœ¨";
            }
        } else {
            cir.classList.remove('active');
            txt.innerText = "Ø¬Ø§Ù‡Ø² Ù„Ø¨Ø¯Ø¡ Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ†";
        }
    }

    function upgrade(type) {
        let cost = type === 'speed' ? 10 : 20;
        if (user.bal >= cost) {
            user.bal -= cost;
            if (type === 'speed') user.speed += 0.05; else user.tank += 2;
            updateUI();
            notify("ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨Ù†Ø¬Ø§Ø­! ğŸ”¥");
        } else notify("Ø§Ù„Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙ! âŒ");
    }

    function showPage(id, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        el.classList.add('active');
    }

    function copyLink() {
        const link = `https://t.me/GoldenClaim_Bot?start=${tg.initDataUnsafe.user?.id || 'ref'}`;
        navigator.clipboard.writeText(link);
        notify("ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©! ğŸ”—");
    }

    function claimTask(reward) {
        notify("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù‡Ù…Ø©...");
        setTimeout(() => {
            user.bal += reward;
            updateUI();
            notify("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©! ğŸ");
        }, 2000);
    }

    setInterval(loop, 1000);
    updateUI();
</script>
</body>
</html>

