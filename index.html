<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Golden Claim | Admin & Mining</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #f3ba2f; --bg: #050505; --card: #141414; --green: #00ffa3; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Cairo', sans-serif; direction: rtl; overflow: hidden; }
        
        .app { height: 100vh; display: flex; flex-direction: column; padding: 15px; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        #ton-connect-button { transform: scale(0.8); }

        .screen { display: none; flex-direction: column; align-items: center; flex-grow: 1; overflow-y: auto; padding-bottom: 120px; }
        .active { display: flex; }

        /* Ø§Ù„ØªØ¹Ø¯ÙŠÙ† */
        .balance-container { text-align: center; margin: 10px 0; }
        .balance-val { font-size: 50px; font-weight: 900; color: var(--gold); text-shadow: 0 0 20px rgba(243,186,47,0.3); }

        .mining-circle {
            width: 220px; height: 220px; border-radius: 50%;
            background: radial-gradient(circle, #1a1a1a 0%, #000 100%);
            border: 5px solid #222; display: flex; align-items: center; justify-content: center;
            position: relative; margin: 20px 0; transition: 0.5s;
        }
        .active-mining { border-color: var(--gold); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(243,186,47,0.4); } 70% { box-shadow: 0 0 0 20px rgba(243,186,47,0); } 100% { box-shadow: 0 0 0 0 rgba(243,186,47,0); } }

        /* ÙƒØ±ÙˆØª Ø§Ù„ØªØ·ÙˆÙŠØ± */
        .cards-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; margin-top: 20px; }
        .upgrade-card { background: var(--card); border: 1px solid #333; border-radius: 20px; padding: 15px; text-align: center; }
        .upgrade-card h4 { margin: 0; font-size: 14px; color: #fff; }
        .upgrade-card p { font-size: 11px; color: var(--gold); margin: 5px 0; }
        .buy-btn { background: #222; color: white; border: 1px solid #444; width: 100%; padding: 8px; border-radius: 12px; font-weight: bold; cursor: pointer; }
        .buy-btn:active { background: var(--gold); color: black; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .admin-item { background: #1a0000; border: 1px solid red; padding: 10px; border-radius: 10px; margin-bottom: 10px; width: 100%; }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙÙ„ÙŠØ© */
        .nav { position: fixed; bottom: 15px; left: 15px; right: 15px; background: rgba(20,20,20,0.9); backdrop-filter: blur(10px); border-radius: 25px; display: flex; justify-content: space-around; padding: 15px; border: 1px solid #333; }
        .nav-item { color: #666; font-size: 12px; font-weight: bold; cursor: pointer; }
        .nav-item.active { color: var(--gold); }
    </style>
</head>
<body>

<div class="app">
    <div class="header">
        <div id="ton-connect-button"></div>
        <div style="display:flex; align-items:center; gap:10px;">
            <span id="u-name" style="font-weight:bold;">...</span>
            <img id="u-avatar" src="" style="width:30px; border-radius:50%; border:1px solid var(--gold);">
        </div>
    </div>

    <div id="home" class="screen active">
        <div class="balance-container">
            <small style="color:#888">Ø±ØµÙŠØ¯Ùƒ Ù…Ù† Ø§Ù„Ø°Ù‡Ø¨</small>
            <div class="balance-val" id="balance">0.0000</div>
        </div>

        <div id="circle" class="mining-circle">
            <div id="status-txt" style="font-weight:900; color:#444; font-size:20px;">Ø®Ø§Ù…Ù„</div>
        </div>

        <div id="timer" style="color:var(--gold); font-weight:bold; margin-bottom:10px;">Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¨Ø¯Ø¡</div>
        <button id="main-btn" onclick="handleMining()" style="background:var(--gold); color:black; border:none; padding:15px 40px; border-radius:50px; font-weight:900; width:80%; cursor:pointer;">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¹Ø¯ÙŠÙ†</button>

        <h3 style="width:100%; text-align:right; margin-top:25px;">ØªØ·ÙˆÙŠØ± Ø§Ù„ØªØ¹Ø¯ÙŠÙ† â›ï¸</h3>
        <div class="cards-grid">
            <div class="upgrade-card">
                <h4>Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø°Ù‡Ø¨ÙŠ</h4>
                <p>+0.05/Ø³Ø§Ø¹Ø©</p>
                <button class="buy-btn" onclick="buyUpgrade('speed', 10)">10 Ø°Ù‡Ø¨</button>
            </div>
            <div class="upgrade-card">
                <h4>Ø®Ø²Ø§Ù† Ø¹Ù…Ù„Ø§Ù‚</h4>
                <p>+2 Ø³Ø§Ø¹Ø© ØªØ¹Ø¯ÙŠÙ†</p>
                <button class="buy-btn" onclick="buyUpgrade('time', 20)">20 Ø°Ù‡Ø¨</button>
            </div>
        </div>
    </div>

    <div id="admin" class="screen">
        <h2 style="color:red">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ù„Ù„Ø¢Ø¯Ù…Ù† ÙÙ‚Ø·)</h2>
        <div id="admin-logs" style="width:100%">
            <div class="admin-item">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø³Ø­Ø¨ Ø­Ø§Ù„ÙŠØ§Ù‹</div>
        </div>
    </div>

    <nav class="nav">
        <div class="nav-item active" onclick="showTab('home', this)">Ø§Ù„ØªØ¹Ø¯ÙŠÙ†</div>
        <div class="nav-item" id="admin-nav" style="display:none;" onclick="showTab('admin', this)">Ø§Ù„Ø¢Ø¯Ù…Ù†</div>
    </nav>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ù…Ø­ÙØ¸Ø©: Ù…Ø§Ù†ÙŠØªÙÙŠØ³Øª Ø±Ø³Ù…ÙŠ ÙˆÙ…ÙˆØ«ÙˆÙ‚
    const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
        manifestUrl: 'https://ton-connect.github.io/demo-dapp-with-react/tonconnect-manifest.json',
        buttonRootId: 'ton-connect-button'
    });

    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    let bal = parseFloat(localStorage.getItem('g_bal')) || 0;
    let rate = parseFloat(localStorage.getItem('g_rate')) || 0.01;
    let limit = parseInt(localStorage.getItem('g_limit')) || 6;
    let endTime = localStorage.getItem('g_end');
    const myID = 12345678; // Ø§Ø³ØªØ¨Ø¯Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… Ø¨Ù€ ID ØªÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ

    function updateUI() {
        document.getElementById('balance').innerText = bal.toFixed(4);
        document.getElementById('u-name').innerText = tg.initDataUnsafe.user?.first_name || "Ø§Ù„Ù…Ø¬Ø§Ù‡Ø¯";
        document.getElementById('u-avatar').src = tg.initDataUnsafe.user?.photo_url || "https://via.placeholder.com/30";
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ø¢Ø¯Ù…Ù† Ù„Ùƒ ÙÙ‚Ø·
        if(tg.initDataUnsafe.user?.id === myID) {
            document.getElementById('admin-nav').style.display = "block";
        }
        localStorage.setItem('g_bal', bal);
        localStorage.setItem('g_rate', rate);
        localStorage.setItem('g_limit', limit);
    }

    function handleMining() {
        if (!endTime) {
            endTime = Date.now() + (limit * 3600000);
            localStorage.setItem('g_end', endTime);
            tg.HapticFeedback.notificationOccurred('success');
        } else if (Date.now() >= endTime) {
            bal += (rate * limit);
            endTime = null;
            localStorage.removeItem('g_end');
            tg.HapticFeedback.impactOccurred('heavy');
            updateUI();
        }
    }

    function buyUpgrade(type, cost) {
        if(bal >= cost) {
            bal -= cost;
            if(type === 'speed') rate += 0.05;
            else limit += 2;
            updateUI();
            alert("ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨Ù†Ø¬Ø§Ø­! ğŸš€");
        } else {
            alert("Ø°Ù‡Ø¨ ØºÙŠØ± ÙƒØ§ÙÙ! âŒ");
        }
    }

    function checkMining() {
        const circle = document.getElementById('circle');
        const status = document.getElementById('status-txt');
        const btn = document.getElementById('main-btn');
        const timer = document.getElementById('timer');

        if (endTime) {
            const diff = endTime - Date.now();
            if (diff > 0) {
                circle.classList.add('active-mining');
                status.innerText = "ØªØ¹Ø¯ÙŠÙ†...";
                status.style.color = "var(--gold)";
                btn.disabled = true;
                btn.style.opacity = "0.5";
                const h = Math.floor(diff/3600000);
                const m = Math.floor((diff%3600000)/60000);
                timer.innerText = `Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${h}Ø³ ${m}Ø¯`;
            } else {
                circle.classList.remove('active-mining');
                status.innerText = "Ø§Ø­ØµØ¯";
                status.style.color = var(--green);
                btn.disabled = false;
                btn.style.opacity = "1";
                btn.innerText = "Ø­ØµØ¯ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­";
                timer.innerText = "Ø§ÙƒØªÙ…Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ†!";
            }
        }
    }

    function showTab(id, el) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        el.classList.add('active');
    }

    setInterval(checkMining, 1000);
    updateUI();
</script>
</body>
</html>

