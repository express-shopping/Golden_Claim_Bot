<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Golden Claim | Hamster Pro</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #f3ba2f; --bg: #000000; --panel: #1c1f24; --text-gray: #888; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            margin: 0; background: var(--bg); color: white; font-family: 'Inter', sans-serif;
            height: 100vh; overflow: hidden; display: flex; flex-direction: column;
            background: radial-gradient(circle at 50% 0%, #2b2e35 0%, #000 100%);
        }

        /* هيدر المحفظة والمستخدم */
        .header { display: flex; justify-content: space-between; align-items: center; padding: 15px; }
        .user-box { display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.05); padding: 5px 12px; border-radius: 15px; border: 1px solid #333; }
        .user-box img { width: 30px; height: 30px; border-radius: 50%; border: 1px solid var(--gold); }
        #ton-connect-btn { scale: 0.8; }

        /* نظام المستويات */
        .stats-container { padding: 0 15px; }
        .level-row { display: flex; justify-content: space-between; font-size: 11px; margin-bottom: 5px; color: var(--gold); font-weight: bold; }
        .progress-bar-bg { width: 100%; height: 8px; background: #222; border-radius: 10px; border: 1px solid #333; overflow: hidden; }
        .progress-bar-fill { height: 100%; background: linear-gradient(90deg, #fff, var(--gold)); width: 0%; transition: 0.5s; box-shadow: 0 0 10px var(--gold); }

        /* الأقسام (Screens) */
        .screen { display: none; flex-direction: column; align-items: center; flex-grow: 1; padding: 20px; width: 100%; }
        .screen.active { display: flex; }

        /* شاشة التعدين (Mining) */
        .score-display { font-size: 45px; font-weight: 900; margin: 20px 0; text-shadow: 0 0 15px rgba(243,186,47,0.3); }
        .coin-wrapper { position: relative; width: 260px; height: 260px; cursor: pointer; transition: transform 0.05s; }
        .coin-wrapper:active { transform: scale(0.95); }
        .main-coin { width: 100%; height: 100%; border-radius: 50%; border: 12px solid #282b30; background: radial-gradient(circle, #f3ba2f 20%, #8a6d1f 100%); box-shadow: 0 0 50px rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; }
        .main-coin span { font-size: 110px; font-weight: 900; color: rgba(0,0,0,0.15); }

        /* تأثير النقر الطائر */
        .floating-num { position: absolute; color: white; font-size: 32px; font-weight: 900; pointer-events: none; animation: flyUp 0.8s forwards; }
        @keyframes flyUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-120px); } }

        /* شاشة المحفظة (Wallet) */
        .wallet-card { width: 100%; background: var(--panel); border-radius: 25px; padding: 30px; border: 1px solid #333; text-align: center; }
        .wallet-card h2 { color: var(--gold); margin-top: 0; }
        .balance-usd { font-size: 40px; font-weight: 900; margin: 20px 0; }

        /* شريط التنقل السفلي */
        .nav-bar { position: fixed; bottom: 15px; left: 15px; right: 15px; background: rgba(28,31,36,0.95); backdrop-filter: blur(15px); border-radius: 20px; display: flex; justify-content: space-around; padding: 12px; border: 1px solid #333; }
        .nav-item { color: var(--text-gray); text-align: center; font-size: 10px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .nav-item.active { color: var(--gold); transform: translateY(-5px); }
        .nav-item svg { width: 22px; height: 22px; display: block; margin: 0 auto 4px; fill: currentColor; }
    </style>
</head>
<body>

    <div class="header">
        <div class="user-box">
            <img id="user-avatar" src="https://via.placeholder.com/30" alt="">
            <span id="user-name" style="font-size: 12px; font-weight: 900;">Loading...</span>
        </div>
        <div id="ton-connect-btn"></div>
    </div>

    <div class="stats-container">
        <div class="level-row">
            <span id="rank-title">BRONZE</span>
            <span>LEVEL <b id="lvl-txt">1</b>/10</span>
        </div>
        <div class="progress-bar-bg"><div class="progress-bar-fill" id="xp-fill"></div></div>
    </div>

    <div id="exchange" class="screen active">
        <div class="score-display" id="total-score">0</div>
        <div class="coin-wrapper" id="tap-target">
            <div class="main-coin"><span>G</span></div>
        </div>
        <div style="width: 100%; margin-top: auto; margin-bottom: 80px;">
            <div style="display:flex; justify-content:space-between; font-size:11px; margin-bottom:5px;">
                <span id="energy-val">1000/1000</span><span>⚡ ENERGY</span>
            </div>
            <div class="progress-bar-bg" style="height:6px;"><div class="progress-bar-fill" id="energy-fill" style="width:100%;"></div></div>
        </div>
    </div>

    <div id="wallet" class="screen">
        <div class="wallet-card">
            <h2>Crypto Assets</h2>
            <p style="color:#888;">Estimated Balance</p>
            <div class="balance-usd">$ <span id="usd-val">0.00</span></div>
            <p style="font-size: 12px; color: var(--gold);">Connect your TON wallet to withdraw</p>
        </div>
    </div>

    <div id="friends" class="screen">
        <h2>Invite Friends</h2>
        <div class="wallet-card" style="padding: 20px;">
            <p>Earn +50,000 for every referral</p>
            <button style="background:var(--gold); border:none; padding:12px 25px; border-radius:12px; font-weight:900; width:100%; cursor:pointer;" onclick="alert('Link Copied!')">COPY LINK</button>
        </div>
    </div>

    <div class="nav-bar">
        <div class="nav-item active" onclick="showScreen('exchange', this)">
            <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>Exchange
        </div>
        <div class="nav-item" onclick="showScreen('friends', this)">
            <svg viewBox="0 0 24 24"><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg>Friends
        </div>
        <div class="nav-item" onclick="showScreen('wallet', this)">
            <svg viewBox="0 0 24 24"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2-.9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8z"/></svg>Wallet
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // 1. ربط المحفظة الحقيقي (TON Connect)
        const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
            manifestUrl: 'https://raw.githubusercontent.com/ton-community/tutorials/main/03-client/test/public/tonconnect-manifest.json',
            buttonRootId: 'ton-connect-btn'
        });

        // 2. جلب بيانات المستخدم الحقيقية من تليجرام
        const user = tg.initDataUnsafe.user;
        if(user) {
            document.getElementById('user-name').innerText = user.first_name;
            if(user.photo_url) document.getElementById('user-avatar').src = user.photo_url;
        }

        // 3. منطق اللعبة
        let score = parseInt(localStorage.getItem('g_score')) || 0;
        let energy = parseInt(localStorage.getItem('g_energy')) || 1000;

        function updateUI() {
            document.getElementById('total-score').innerText = score.toLocaleString();
            document.getElementById('energy-val').innerText = `${energy}/1000`;
            document.getElementById('energy-fill').style.width = (energy/10) + "%";
            
            // تحديث شريط المستوى
            let prog = (score % 5000) / 50;
            document.getElementById('xp-fill').style.width = prog + "%";
            document.getElementById('lvl-txt').innerText = Math.floor(score/5000) + 1;
            
            localStorage.setItem('g_score', score);
            localStorage.setItem('g_energy', energy);
        }

        // 4. تفعيل النقرات وتأثيراتها
        document.getElementById('tap-target').addEventListener('touchstart', (e) => {
            e.preventDefault();
            if(energy > 0) {
                score += 1; energy -= 1;
                updateUI();
                createFloatingText(e.touches[0].clientX, e.touches[0].clientY);
                if(navigator.vibrate) navigator.vibrate(5);
            }
        });

        function createFloatingText(x, y) {
            const el = document.createElement('div');
            el.className = 'floating-num';
            el.innerText = '+1';
            el.style.left = x + 'px'; el.style.top = y + 'px';
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 800);
        }

        // 5. تفعيل الأزرار والتنقل بين الشاشات
        function showScreen(screenId, navEl) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            navEl.classList.add('active');
        }

        // تجديد الطاقة تلقائياً
        setInterval(() => { if(energy < 1000) { energy += 1; updateUI(); } }, 1500);
        updateUI();
    </script>
</body>
</html>

