<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Golden Claim | Pro Max</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #f3ba2f; --bg: #000; --card: #1c1f24; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Montserrat', sans-serif; overflow: hidden; height: 100vh; }
        .app { height: 100vh; display: flex; flex-direction: column; padding: 15px; background: radial-gradient(circle at 50% 0%, #2c2f35 0%, #000 100%); }
        
        /* Header */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .u-info { display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.05); padding: 5px 12px; border-radius: 15px; border: 1px solid #333; }
        .u-info img { width: 30px; height: 30px; border-radius: 50%; border: 1px solid var(--gold); }
        
        .screen { display: none; flex-direction: column; align-items: center; flex-grow: 1; overflow-y: auto; padding-bottom: 100px; }
        .active { display: flex; }

        /* Coin Style */
        .score { font-size: 45px; font-weight: 900; margin: 20px 0; }
        .coin { width: 250px; height: 250px; border-radius: 50%; border: 10px solid #25282e; background: radial-gradient(circle, #f3ba2f 10%, #8a6d1f 100%); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.05s; }
        .coin:active { transform: scale(0.95); }
        .coin span { font-size: 100px; color: rgba(0,0,0,0.1); font-weight: 900; }

        /* Task & Admin Cards */
        .card { background: var(--card); width: 100%; border-radius: 20px; padding: 15px; border: 1px solid #333; margin-bottom: 10px; }
        .btn { background: var(--gold); color: #000; border: none; padding: 10px; border-radius: 10px; font-weight: 900; cursor: pointer; width: 100%; }
        
        /* Nav */
        .nav { position: fixed; bottom: 10px; left: 10px; right: 10px; background: #1c1f24; border-radius: 20px; display: flex; justify-content: space-around; padding: 12px; border: 1px solid #333; }
        .nav-item { color: #888; text-align: center; font-size: 10px; font-weight: bold; cursor: pointer; }
        .nav-item.active { color: var(--gold); }
        .nav-item svg { width: 22px; height: 22px; display: block; margin: 0 auto 4px; fill: currentColor; }
    </style>
</head>
<body>

<div class="app">
    <div class="header">
        <div class="u-info">
            <img id="u-avatar" src="">
            <span id="u-name" style="font-size:12px;">Loading...</span>
        </div>
        <div id="ton-connect"></div>
    </div>

    <div id="home" class="screen active">
        <div class="score" id="score-val">0</div>
        <div class="coin" id="coin-btn"><span>G</span></div>
    </div>

    <div id="tasks" class="screen">
        <h2 style="color:var(--gold)">Daily Tasks</h2>
        <div class="card">
            <div style="margin-bottom:10px;"><b>Subscribe to Channel</b></div>
            <div style="font-size:12px; color:#aaa; margin-bottom:10px;">Reward: +50,000 Gold</div>
            <button class="btn" onclick="doTask('https://t.me/YourChannel', 50000)">GO TO CHANNEL</button>
        </div>
    </div>

    <div id="wallet" class="screen">
        <div class="card" style="text-align:center; padding: 30px;">
            <div style="font-size: 50px;">ðŸ’°</div>
            <h2>Withdrawal</h2>
            <p style="color:#888; font-size:12px;">Min withdrawal: 1,000,000 Gold</p>
            <div style="font-size:35px; font-weight:900; margin:15px 0;" id="with-score">0</div>
            <button id="withdraw-btn" class="btn" onclick="processWithdraw()">WITHDRAW TO WALLET</button>
            <p id="status-msg" style="font-size:10px; margin-top:10px;"></p>
        </div>
    </div>

    <div id="admin" class="screen">
        <h2 style="color:red">Admin Panel</h2>
        <div id="requests-list" style="width:100%">
            <p style="text-align:center; color:#888;">No pending requests</p>
        </div>
    </div>

    <nav class="nav">
        <div class="nav-item active" onclick="showTab('home', this)"><svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>Home</div>
        <div class="nav-item" onclick="showTab('tasks', this)"><svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg>Tasks</div>
        <div class="nav-item" onclick="showTab('wallet', this)"><svg viewBox="0 0 24 24"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8z"/></svg>Wallet</div>
        <div class="nav-item" id="admin-nav" style="display:none;" onclick="showTab('admin', this)"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08s5.97 1.09 6 3.08c-1.29 1.94-3.5 3.22-6 3.22z"/></svg>Admin</div>
    </nav>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø©
    const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
        manifestUrl: 'https://raw.githubusercontent.com/ton-community/tutorials/main/03-client/test/public/tonconnect-manifest.json',
        buttonRootId: 'ton-connect'
    });

    let score = parseInt(localStorage.getItem('sc')) || 0;
    const adminID = 12345678; // Ø¶Ø¹ Ø±Ù‚Ù… ID Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§ Ù„ØªØ¸Ù‡Ø± Ù„Ùƒ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…

    function updateUI() {
        document.getElementById('score-val').innerText = score.toLocaleString();
        document.getElementById('with-score').innerText = score.toLocaleString();
        document.getElementById('u-name').innerText = tg.initDataUnsafe.user?.first_name || "Mugahed";
        document.getElementById('u-avatar').src = tg.initDataUnsafe.user?.photo_url || "https://via.placeholder.com/30";
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ø¢Ø¯Ù…Ù† ÙÙ‚Ø·
        if(tg.initDataUnsafe.user?.id === adminID) {
            document.getElementById('admin-nav').style.display = "block";
        }
        localStorage.setItem('sc', score);
    }

    // Ø§Ù„Ù†Ù‚Ø±
    document.getElementById('coin-btn').addEventListener('touchstart', (e) => {
        e.preventDefault();
        score += 1; updateUI();
        if(navigator.vibrate) navigator.vibrate(5);
    });

    // Ø§Ù„Ù…Ù‡Ø§Ù…
    function doTask(url, reward) {
        window.open(url, '_blank');
        setTimeout(() => {
            score += reward; updateUI();
            alert("Reward claimed! + " + reward);
        }, 5000);
    }

    // Ø§Ù„Ø³Ø­Ø¨
    function processWithdraw() {
        if (!tonConnectUI.connected) { alert("Connect Wallet First!"); return; }
        if (score < 1000000) { alert("Need 1M Gold!"); return; }
        
        const req = { user: tg.initDataUnsafe.user?.first_name, amount: score, id: Date.now() };
        let requests = JSON.parse(localStorage.getItem('pending_reqs')) || [];
        requests.push(req);
        localStorage.setItem('pending_reqs', JSON.stringify(requests));
        
        score = 0; updateUI();
        alert("Request Sent to Admin!");
        renderAdmin();
    }

    // Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    function renderAdmin() {
        const list = document.getElementById('requests-list');
        const reqs = JSON.parse(localStorage.getItem('pending_reqs')) || [];
        list.innerHTML = reqs.map(r => `
            <div class="card">
                <div>User: ${r.user}</div>
                <div>Amount: ${r.amount}</div>
                <button class="btn" onclick="approve(${r.id})">APPROVE & PAY</button>
            </div>
        `).join('') || '<p style="text-align:center">No requests</p>';
    }

    function approve(id) {
        let reqs = JSON.parse(localStorage.getItem('pending_reqs')) || [];
        reqs = reqs.filter(r => r.id !== id);
        localStorage.setItem('pending_reqs', JSON.stringify(reqs));
        alert("Payment Approved!");
        renderAdmin();
    }

    function showTab(id, el) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        el.classList.add('active');
        if(id === 'admin') renderAdmin();
    }

    updateUI();
</script>
</body>
</html>

